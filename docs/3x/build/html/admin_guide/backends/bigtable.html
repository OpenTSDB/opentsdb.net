<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bigtable &#8212; OpenTSDB 3.0 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          OpenTSDB</a>
        <span class="navbar-text navbar-version pull-left"><b>3.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://github.com/OpenTSDB/opentsdb/releases">Download</a></li>
                <li><a href="https://github.com/OpenTSDB/opentsdb">Source</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Documentation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changes in 3.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../changes.html#new-features">New Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changes.html#whats-missing">Whats Missing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation and Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#runtime-requirements">Runtime Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#compile">Compile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#docker">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#local">Local</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#id1">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#querying">Querying</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">Users Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/semanticquery/index.html">Semantic Query (Version 3)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Administrators Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html">TSDB Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging.html">Logging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api_http/index.html">HTTP API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#version-2-x-to-3-x">Version 2.X to 3.x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#authentication-permissions">Authentication/Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#response-codes">Response Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#errors">Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#verbs">Verbs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#query-string-vs-body-content">Query String Vs. Body Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#compressed-requests">Compressed Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#cors">CORS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#deprecated-api">Deprecated API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#api-endpoints">API Endpoints</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Bigtable</a><ul>
<li><a class="reference internal" href="#setup">Setup</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="bigtable">
<h1>Bigtable</h1>
<p><a class="reference external" href="https://cloud.google.com/">Google Cloud Platform</a> provides hosting of Google’s Bigtable database, the original inspiration of HBase and many NoSQL storage systems. Because HBase is so similar to Bigtable, running OpenTSDB 2.3 and later with Google’s backend is simple. Indeed, the schemas (see <a class="reference internal" href="hbase.html"><span class="doc">HBase Schema</span></a>) are exactly the same so all you have to do is create your Bigtable instance, create your TSDB tables using the Bigtable HBase shell, and fire up the TSDs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The clients for Bigtable are in beta and undergoing a number of changes. Performance should improve as we adjust the code and uncover new tuning parameters. Please help us out on the mailing list or by modifying the code in GitHub.</p>
</div>
<div class="section" id="setup">
<h2>Setup</h2>
<ol class="arabic simple">
<li><p>Setup your Google Cloud Platform account.</p></li>
<li><p>Follow the steps in <a class="reference external" href="https://cloud.google.com/bigtable/docs/creating-cluster">Creating a Cloud Bigtable Cluster</a>.</p></li>
<li><p>Follow the steps in <a class="reference external" href="https://cloud.google.com/bigtable/docs/hbase-shell-quickstart">HBase Shell Quickstart</a>, paying attention to where you download your JSON key file.</p></li>
<li><p>Set the <cite>HBASE_HOME</cite> environment variable to your Bigtable shell directory, make sure the <cite>HBASE_CLASSPATH</cite>, <cite>JAVA_HOME</cite>, and <cite>GOOGLE_APPLICATION_CREDENTIALS</cite> environment variables have been set according to the values in <cite>Creating a Cloud BigTable Cluster</cite> document, and run the <cite>src/create_table.sh</cite> script. If the script fails to launch the shell, try running the shell manually and execute the <cite>create</cite> statements substituting the proper values.</p></li>
<li><p>Build TSDB by executing <cite>sh build-bigtable.sh</cite> (or if you prefer Maven, <cite>sh build-bigtable.sh pom.xml</cite>)</p></li>
<li><p>Prepare the <cite>opentsdb.conf</cite> file with the required and/or optional configuration parameters below.</p></li>
<li><p>Run the TSD via <cite>build/tsdb tsd –config=&lt;path&gt;/opentsdb.conf</cite></p></li>
</ol>
</div>
<div class="section" id="configuration">
<h2>Configuration</h2>
<p>The following is a table of required and optional parameters to run OpenTSDB with Bigtable. These are in addition to the standard TSD configuration parameters from <a class="reference internal" href="../configuration.html"><span class="doc">TSDB Configuration</span></a>.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 60%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Required</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>google.bigtable.project.id</p></td>
<td><p>String</p></td>
<td><p>Required</p></td>
<td><p>The project ID hosting your Bigtable cluster.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>google.bigtable.instance.id</p></td>
<td><p>String</p></td>
<td><p>Required</p></td>
<td><p>The cluster ID you assigned to your Bigtable cluster at creation. Note that prior to AsyncBigtable 0.3.0 the value was <code class="docutils literal notranslate"><span class="pre">google.bigtable.cluster.name</span></code>.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>google.bigtable.zone.id</p></td>
<td><p>String</p></td>
<td><p>Required</p></td>
<td><p>The zone where your Bigtable cluster is operating; chosen at creation. Note that prior to AsyncBigtable 0.3.0 the value was <code class="docutils literal notranslate"><span class="pre">google.bigtable.zone.name</span></code>.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>hbase.client.connection.impl</p></td>
<td><p>String</p></td>
<td><p>Required</p></td>
<td><p>The class that will be used to implement the HBase API AsyncBigtable will use as a shim between the Bigtable client and OpenTSDB. Set this to <code class="docutils literal notranslate"><span class="pre">com.google.cloud.bigtable.hbase1_2.BigtableConnection</span></code> (or prior to AsyncBigtable 0.3.0 <code class="docutils literal notranslate"><span class="pre">com.google.cloud.bigtable.hbase1_0.BigtableConnection</span></code>).</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>google.bigtable.auth.service.account.enable</p></td>
<td><p>Boolean</p></td>
<td><p>Required</p></td>
<td><p>Whether or not to use a Google cloud service account to connect. Set this to <cite>true</cite></p></td>
<td><p>false</p></td>
</tr>
<tr class="row-odd"><td><p>google.bigtable.auth.json.keyfile</p></td>
<td><p>String</p></td>
<td><p>Required</p></td>
<td><p>The full path to the JSON formatted key file associated with the service account you want to use for Bigtable access. Download this from your cloud console.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>google.bigtable.grpc.channel.count</p></td>
<td><p>Integer</p></td>
<td><p>Optional</p></td>
<td><p>The number of sockets opened to the Bigtable API for handling RPCs. For higher throughput consider increasing the channel count.</p></td>
<td><p>4</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In older version’s of the client, Google’s Bigtable client communicates with their servers over HTTP2 with TLS using ALPN. As Java 7 and 8 (dunno about 9) lack native ALPN support, a <a class="reference external" href="http://www.eclipse.org/jetty/documentation/current/alpn-chapter.html">library</a> must be loaded at JVM start to modify the JVM’s bytecode. The build script for OpenTSDB will attempt to detect your JDK version and download the proper version of ALPN but if you have a custom JVM or something other than Hotspot or OpenJDK you may run into issues. Try different versions of the <cite>alpn-boot</cite> JAR to see what works for you. With AsyncBigtable 0.3.0 a JDK agnostic library is used so ALPN is no longer required.</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021, OpenTSDB.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>