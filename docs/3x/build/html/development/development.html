<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Development &#8212; OpenTSDB 3.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Query Path Development" href="query_development.html" />
    <link rel="prev" title="Development" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          OpenTSDB</a>
        <span class="navbar-text navbar-version pull-left"><b>3.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://github.com/OpenTSDB/opentsdb/releases">Download</a></li>
                <li><a href="https://github.com/OpenTSDB/opentsdb">Source</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Documentation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Changes in 3.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changes.html#new-features">New Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changes.html#whats-missing">Whats Missing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation and Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#runtime-requirements">Runtime Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#quickstart">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#querying">Querying</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#write-data">Write Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">Users Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/index.html#querying-data">Querying Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/index.html#writing-data">Writing Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/index.html">Administrators Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../admin_guide/configuration/index.html">TSDB Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../admin_guide/logging.html">Logging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_http/index.html">HTTP API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_http/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_http/index.html#version-2-x-to-3-x">Version 2.X to 3.x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_http/index.html#authentication-permissions">Authentication/Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_http/index.html#response-codes">Response Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_http/index.html#errors">Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_http/index.html#verbs">Verbs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_http/index.html#query-string-vs-body-content">Query String Vs. Body Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_http/index.html#compressed-requests">Compressed Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_http/index.html#cors">CORS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_http/index.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_http/index.html#deprecated-api">Deprecated API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_http/index.html#api-endpoints">API Endpoints</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#git-repository">Git Repository</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#details">Details</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="index.html" title="Previous Chapter: Development"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Development</span>
    </a>
  </li>
  <li>
    <a href="query_development.html" title="Next Chapter: Query Path Development"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Query Path De... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">General Development</a><ul>
<li><a class="reference internal" href="#building">Building</a></li>
<li><a class="reference internal" href="#project-layout">Project Layout</a></li>
<li><a class="reference internal" href="#contributing">Contributing</a></li>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="general-development">
<h1>General Development</h1>
<p>OpenTSDB 1.x and 2.x used Make to compile in a non-Java’y way. 3.x uses straight Maven with modules and is compatible with IDEs. This page goes over general dev and building guidelines.</p>
<div class="section" id="building">
<h2>Building</h2>
<p>Standard <code class="docutils literal notranslate"><span class="pre">mvn</span></code> commands work fine. E.g. <code class="docutils literal notranslate"><span class="pre">mvn</span> <span class="pre">clean</span> <span class="pre">package</span></code> will cleanout existing builds, build each module and run it’s unit test, and create a distribution tarball in <code class="docutils literal notranslate"><span class="pre">distribution/target/</span></code>.</p>
</div>
<div class="section" id="project-layout">
<h2>Project Layout</h2>
<p>The TSDB code base now uses modules with the primary focus being on adding features via plugins. Note that this is still Java 8 modules and we haven’t started the ugly migration process of using the Java 9x module system wherein packages should not overlap. In general, interfaces are in the common module while implementations of those same classes are in other modules. We could use some help with organization.</p>
<p>The modules or directories include:</p>
<ul class="simple">
<li><p><strong>common</strong> - The common interfaces and utilities along with implementations that do not require dependencies. The goal is to keep this generically applicable and only include dependencies other modules may not require (though Netty and Jackson snuck in unfortunately). This is just a library.</p></li>
<li><p><strong>core</strong> - This is the core write and read module of OpenTSDB in that it handles the routing of data, query planning, etc. It’s just a library and still needs another module to turn up a useful daemon (generally the <code class="docutils literal notranslate"><span class="pre">server-undertow</span></code> module with <code class="docutils literal notranslate"><span class="pre">TSDMain.java</span></code>). This is just a library.</p></li>
<li><p><strong>Executors</strong> - This is a directory that was meant to hold various RPC implementations to communicate between TSDB components. It only has the <code class="docutils literal notranslate"><span class="pre">http</span></code> implementation right now so we’ll probably reorganize this at some point.</p></li>
<li><p><strong>Implementations</strong> - A catch-all module directory for now that has all kinds of plugins and utilities like the <code class="docutils literal notranslate"><span class="pre">servlet</span></code> module to handle JAX-RS servlets for an HTTP server and <code class="docutils literal notranslate"><span class="pre">server-undertow</span></code> that can spin up a TSD server using the servlets. It also has Prometheus and Influx query/data converters.</p></li>
<li><p><strong>Storage</strong> - A directory with storage implentations like the HBase integration and Google Bigtable. Also some queue/pubsub modules.</p></li>
<li><p><strong>Distribution</strong> - The module that is responsible for building a distributable tarball and Docker container(s).</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are still directories (<code class="docutils literal notranslate"><span class="pre">src</span></code>, <code class="docutils literal notranslate"><span class="pre">test</span></code>) and files from the 2.x code path. This is so we can <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">mv</span> <span class="pre">...</span></code> files from the old to the new, make changes and maintain contribution history.</p>
</div>
</div>
<div class="section" id="contributing">
<h2>Contributing</h2>
<ul class="simple">
<li><p>Please file <a class="reference external" href="https://github.com/OpenTSDB/opentsdb/issues">issues on GitHub</a> after checking to see if anyone has posted a bug already. Make sure your bug reports contain enough details so they can be easily understood by others and quickly fixed.</p></li>
<li><p>The best way to contribute code is to fork the main repo and <a class="reference external" href="https://help.github.com/articles/using-pull-requests">send a pull request</a> on GitHub.</p>
<ul>
<li><p>Bug fixes should be done in the <code class="docutils literal notranslate"><span class="pre">master</span></code> branch</p></li>
<li><p>New features or major changes should be done in the <code class="docutils literal notranslate"><span class="pre">next</span></code> branch</p></li>
</ul>
</li>
<li><p>Alternatively, you can send a plain-text patch to the <a class="reference external" href="https://groups.google.com/forum/#!forum/opentsdb">mailing list</a>.</p></li>
<li><p>Before your code changes can be included, please file the <a class="reference external" href="https://docs.google.com/spreadsheet/embeddedform?formkey=dFNiOFROLXJBbFBmMkQtb1hNMWhUUnc6MQ">Contribution License Agreement</a>.</p></li>
<li><p>Unlike, say, the Apache Software Foundation, we do not require every single code change to be attached to an issue. Feel free to send as many small fixes as you want.</p></li>
<li><p>Please break down your changes into as many small commits as possible.</p></li>
<li><p>Please <em>respect the coding style of the code</em> you’re changing (as much as possible. We’re less picky about this now).</p>
<ul>
<li><p>Indent code with 2 spaces, no tabs</p></li>
<li><p>Keep code to 80 columns</p></li>
<li><p>Curly brace on the same line as <code class="docutils literal notranslate"><span class="pre">if</span></code>, <code class="docutils literal notranslate"><span class="pre">for</span></code>, <code class="docutils literal notranslate"><span class="pre">while</span></code>, etc</p></li>
<li><p>Variables need descriptive names <code class="docutils literal notranslate"><span class="pre">like_this</span></code> (instead of the typical Java style of <code class="docutils literal notranslate"><span class="pre">likeThis</span></code>)</p></li>
<li><p>Methods named <code class="docutils literal notranslate"><span class="pre">likeThis()</span></code> starting with lower case letters</p></li>
<li><p>Classes named <code class="docutils literal notranslate"><span class="pre">LikeThis</span></code>, starting with upper case letters</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">final</span></code> keyword as much as you can, particularly in method parameters and returns statements.</p></li>
<li><p>Avoid checked exceptions as much as possible</p></li>
<li><p>Always provide the most restrictive visibility to classes and members</p></li>
<li><p>Javadoc all of your classes and methods. Some folks make use the Java API directly and we’ll build docs for the site, so the more the merrier</p></li>
<li><p>Don’t add dependencies to the core OpenTSDB library unless absolutely necessary</p></li>
<li><p>Add unit tests for any classes/methods you create and verify that your change doesn’t break existing unit tests. We know UTs aren’t fun, but they are useful</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="dependencies">
<h2>Dependencies</h2>
<p>Do not add dependencies to the <cite>common</cite> or <cite>core</cite> modules if at all possible. If you have a dependency you can’t bypass, try writing a plugin.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021, OpenTSDB.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>