<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CLI Tools &#8212; OpenTSDB 3.0 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          OpenTSDB</a>
        <span class="navbar-text navbar-version pull-left"><b>3.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://github.com/OpenTSDB/opentsdb/releases">Download</a></li>
                <li><a href="https://github.com/OpenTSDB/opentsdb">Source</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Documentation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changes in 3.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../changes.html#new-features">New Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changes.html#whats-missing">Whats Missing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation and Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#runtime-requirements">Runtime Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#compile">Compile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#docker">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#local">Local</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#id1">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#querying">Querying</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">Users Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/semanticquery/index.html">Semantic Query (Version 3)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Administrators Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html">TSDB Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging.html">Logging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api_http/index.html">HTTP API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#version-2-x-to-3-x">Version 2.X to 3.x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#authentication-permissions">Authentication/Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#response-codes">Response Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#errors">Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#verbs">Verbs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#query-string-vs-body-content">Query String Vs. Body Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#compressed-requests">Compressed Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#cors">CORS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#deprecated-api">Deprecated API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_http/index.html#api-endpoints">API Endpoints</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">CLI Tools</a><ul>
<li><a class="reference internal" href="#common-parameters">Common Parameters</a></li>
<li><a class="reference internal" href="#site-specific-configuration">Site-specific Configuration</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="cli-tools">
<h1>CLI Tools</h1>
<p>OpenTSDB consists of a single JAR file that uses a shell script to determine what actiosn the user wants to take. While the most common action is to start the TSD with the <code class="docutils literal notranslate"><span class="pre">tsd</span></code> command so that it can run all the time and process RPCs, other commands are available to work with OpenTSDB data. These commands include:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="uid.html">uid</a></li>
<li class="toctree-l1"><a class="reference internal" href="mkmetric.html">mkmetric</a></li>
<li class="toctree-l1"><a class="reference internal" href="import.html">import</a></li>
<li class="toctree-l1"><a class="reference internal" href="query.html">query</a></li>
<li class="toctree-l1"><a class="reference internal" href="fsck.html">fsck</a></li>
<li class="toctree-l1"><a class="reference internal" href="scan.html">scan</a></li>
<li class="toctree-l1"><a class="reference internal" href="search.html">search</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsd.html">tsd</a></li>
</ul>
</div>
<p>Accessing a CLI tool is performed from the location of the <code class="docutils literal notranslate"><span class="pre">tsdb</span></code> file, built after compiling OpenTSDB. By default the tsdb file will be located in the <code class="docutils literal notranslate"><span class="pre">build</span></code> directory so you may access it via <code class="docutils literal notranslate"><span class="pre">./build/tsdb</span></code>. Provide the name of the CLI utility as in <code class="docutils literal notranslate"><span class="pre">./build/tsdb</span> <span class="pre">tsd</span></code>.</p>
<div class="section" id="common-parameters">
<h2>Common Parameters</h2>
<p>All command line utilities share some common command line parameters:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 5%" />
<col style="width: 40%" />
<col style="width: 5%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>–config</p></td>
<td><p>String</p></td>
<td><p>The full or relative path to an OpenTSDB <a class="reference internal" href="../configuration.html"><span class="doc">TSDB Configuration</span></a> file. If this parameter is not provided, the command will attempt to load the default config file.</p></td>
<td><p>See <a class="reference internal" href="../configuration.html"><span class="doc">TSDB Configuration</span></a></p></td>
<td><p>–config=/usr/local/tempconfig.conf</p></td>
</tr>
<tr class="row-odd"><td><p>–table</p></td>
<td><p>String</p></td>
<td><p>Name of the HBase table where datapoints are stored</p></td>
<td><p>tsdb</p></td>
<td><p>–table=prod-tsdb</p></td>
</tr>
<tr class="row-even"><td><p>–uidtable</p></td>
<td><p>String</p></td>
<td><p>Name of the HBase table where UID information is stored</p></td>
<td><p>tsdb-uid</p></td>
<td><p>–uidtable=prod-tsdb-uid</p></td>
</tr>
<tr class="row-odd"><td><p>–verbose</p></td>
<td><p>Boolean</p></td>
<td><p>For some CLI tools, this command will allow for INFO and above logging per the logback.xml config. Otherwise without this flag, some tools may only log WARNing messages.</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>–zkbasedir</p></td>
<td><p>String</p></td>
<td><p>Path under which is the znode for the -ROOT- region</p></td>
<td><p>/hbase</p></td>
<td><p>–zkbasedir=/prod/hbase</p></td>
</tr>
<tr class="row-odd"><td><p>–read-only</p></td>
<td><p>Boolean</p></td>
<td><p>Sets the mode for OpenTSDB</p></td>
<td><p>false</p></td>
<td><p>–read-only</p></td>
</tr>
<tr class="row-even"><td><p>–zkquorum</p></td>
<td><p>String</p></td>
<td><p>Specification of the ZooKeeper quorum to use, i.e. a list of servers and/or ports in the ZooKeeper cluster</p></td>
<td><p>localhost</p></td>
<td><p>–zkquorum=zkhost1,zkhost2,zkhost3</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="site-specific-configuration">
<h2>Site-specific Configuration</h2>
<p>The common parameters above are required by all the CLI commands. It can be tedious to manually type them over and over again. You can instead store typically used values in a file <code class="docutils literal notranslate"><span class="pre">./tsdb.local</span></code>. This file is expected to be a shell script and will be sourced by <code class="docutils literal notranslate"><span class="pre">./tsdb</span></code> if it exists.</p>
<p><em>Setting default values for common parameters</em></p>
<p>If, for example, your ZooKeeper quorum is behind the DNS name “zookeeper.example.com” (a name with 5 A records), instead of always passing <code class="docutils literal notranslate"><span class="pre">--zkquorum=zookeeper.example.com</span></code> to the CLI tool each time you use it, you can create <code class="docutils literal notranslate"><span class="pre">./tsdb.local</span></code> with the following contents:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="nv">MY_ARGS</span><span class="o">=</span><span class="s1">&#39;--zkquorum=zookeeper&#39;</span>
<span class="nb">set</span> x <span class="nv">$MY_ARGS</span> <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
<span class="nb">shift</span>
</pre></div>
</div>
<p><em>Overriding the timezone of the TSD</em></p>
<p>Servers are frequently using UTC as their timezone. By default, the TSD renders graphs using the local timezone of the server. You can override this to have graphs in your local time by specifying a timezone in <code class="docutils literal notranslate"><span class="pre">./tsdb.local</span></code>. For example, if you’re in California, this will force the TSD to use your timezone:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> <span class="nb">export</span> <span class="nv">TZ</span><span class="o">=</span>PST8PDT &gt;&gt;tsdb.local
</pre></div>
</div>
<p>On most Linux and BSD systems, you can look under <code class="docutils literal notranslate"><span class="pre">/usr/share/zoneinfo</span></code> for names of timezones supported on your system.</p>
<p><em>Changing JVM parameters</em></p>
<p>You might want to adjust JVM parameters, for instance to turn on GC activity logging or to set the size of various memory regions. In order to do so, simply set the variable JVMARGS in <code class="docutils literal notranslate"><span class="pre">./tsdb.local</span></code>.</p>
<p>Here is an example that is recommended for production use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">GCARGS</span><span class="o">=</span><span class="s2">&quot;-XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintGCDateStamps\</span>
<span class="s2"> -XX:+PrintTenuringDistribution -Xloggc:/tmp/tsd-gc-`date +%s`.log&quot;</span>
<span class="k">if</span> <span class="nb">test</span> -t <span class="m">0</span><span class="p">;</span> <span class="k">then</span> <span class="c1"># if stdin is a tty, don&#39;t turn on GC logging.</span>
  <span class="nv">GCARGS</span><span class="o">=</span>
<span class="k">fi</span>
<span class="c1"># The Sun JDK caches all name resolution results forever, which is stupid.</span>
<span class="c1"># This forces you to restart your application if any of the backends change</span>
<span class="c1"># IP. Instead tell it to cache names for only 10 minutes at most.</span>
<span class="nv">FIX_DNS</span><span class="o">=</span><span class="s1">&#39;-Dsun.net.inetaddr.ttl=600&#39;</span>
<span class="nv">JVMARGS</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$JVMARGS</span><span class="s2"> </span><span class="nv">$GCARGS</span><span class="s2"> </span><span class="nv">$FIX_DNS</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021, OpenTSDB.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>