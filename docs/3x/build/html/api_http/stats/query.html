<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>/api/stats/query &#8212; OpenTSDB 3.0 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/opentsdb_logo_square_sm.png"></span>
          OpenTSDB</a>
        <span class="navbar-text navbar-version pull-left"><b>3.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://github.com/OpenTSDB/opentsdb/releases">Download</a></li>
                <li><a href="https://github.com/OpenTSDB/opentsdb">Source</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Documentation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">/api/stats/query</a><ul>
<li><a class="reference internal" href="#verbs">Verbs</a></li>
<li><a class="reference internal" href="#requests">Requests</a><ul>
<li><a class="reference internal" href="#example-request">Example Request</a></li>
</ul>
</li>
<li><a class="reference internal" href="#response">Response</a><ul>
<li><a class="reference internal" href="#example-response">Example Response</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="api-stats-query">
<h1>/api/stats/query</h1>
<p>This endpoint can be used for tracking and troubleshooting queries executed against a TSD. It maintains an unbounded list of currently executing queries as well as a list of up to 256 completed queries (rotating the oldest queries out of memory). Information about each query includes the original query, request headers, response code, timing and an exception if thrown. (v2.2)</p>
<div class="section" id="verbs">
<h2>Verbs</h2>
<ul class="simple">
<li>GET</li>
</ul>
</div>
<div class="section" id="requests">
<h2>Requests</h2>
<p>No parameters available.</p>
<div class="section" id="example-request">
<h3>Example Request</h3>
<p><strong>Query String</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">4242</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">stats</span><span class="o">/</span><span class="n">query</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="response">
<h2>Response</h2>
<p>The response includes two arrays. <code class="docutils literal"><span class="pre">completed</span></code> lists the 256 most recent queries that have finished execution, whether successfully or with an error. The <code class="docutils literal"><span class="pre">running</span></code> array contains a list of queries currently executing. If this list is growing, the TSD is under heavy load. Note that the running list will not contain an exception, response code or timing details.</p>
<p>For information on the various sections and data from the stats endpoint, see <a class="reference internal" href="../../user_guide/query/stats.html"><span class="doc">Query Details and Stats</span></a>.</p>
<div class="section" id="example-response">
<h3>Example Response</h3>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
      <span class="s2">&quot;completed&quot;</span><span class="o">:</span> <span class="p">[{</span>
              <span class="s2">&quot;query&quot;</span><span class="o">:</span> <span class="p">{</span>
                      <span class="s2">&quot;start&quot;</span><span class="o">:</span> <span class="s2">&quot;1455531250181&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;end&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
                      <span class="s2">&quot;timezone&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
                      <span class="s2">&quot;options&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
                      <span class="s2">&quot;padding&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
                      <span class="s2">&quot;queries&quot;</span><span class="o">:</span> <span class="p">[{</span>
                              <span class="s2">&quot;aggregator&quot;</span><span class="o">:</span> <span class="s2">&quot;zimsum&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;metric&quot;</span><span class="o">:</span> <span class="s2">&quot;tsd.connectionmgr.bytes.written&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;tsuids&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
                              <span class="s2">&quot;downsample&quot;</span><span class="o">:</span> <span class="s2">&quot;1m-avg&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;rate&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                              <span class="s2">&quot;filters&quot;</span><span class="o">:</span> <span class="p">[{</span>
                                      <span class="s2">&quot;tagk&quot;</span><span class="o">:</span> <span class="s2">&quot;colo&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;filter&quot;</span><span class="o">:</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;group_by&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                                      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;wildcard&quot;</span>
                              <span class="p">},</span> <span class="p">{</span>
                                      <span class="s2">&quot;tagk&quot;</span><span class="o">:</span> <span class="s2">&quot;env&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;filter&quot;</span><span class="o">:</span> <span class="s2">&quot;prod&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;group_by&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                                      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;literal_or&quot;</span>
                              <span class="p">},</span> <span class="p">{</span>
                                      <span class="s2">&quot;tagk&quot;</span><span class="o">:</span> <span class="s2">&quot;role&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;filter&quot;</span><span class="o">:</span> <span class="s2">&quot;frontend&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;group_by&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                                      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;literal_or&quot;</span>
                              <span class="p">}],</span>
                              <span class="s2">&quot;rateOptions&quot;</span><span class="o">:</span> <span class="p">{</span>
                                      <span class="s2">&quot;counter&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                                      <span class="s2">&quot;counterMax&quot;</span><span class="o">:</span> <span class="mi">9223372036854775807</span><span class="p">,</span>
                                      <span class="s2">&quot;resetValue&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
                                      <span class="s2">&quot;dropResets&quot;</span><span class="o">:</span> <span class="kc">false</span>
                              <span class="p">},</span>
                              <span class="s2">&quot;tags&quot;</span><span class="o">:</span> <span class="p">{</span>
                                      <span class="s2">&quot;role&quot;</span><span class="o">:</span> <span class="s2">&quot;literal_or(frontend)&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;env&quot;</span><span class="o">:</span> <span class="s2">&quot;literal_or(prod)&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;colo&quot;</span><span class="o">:</span> <span class="s2">&quot;wildcard(*)&quot;</span>
                              <span class="p">}</span>
                      <span class="p">},</span> <span class="p">{</span>
                              <span class="s2">&quot;aggregator&quot;</span><span class="o">:</span> <span class="s2">&quot;zimsum&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;metric&quot;</span><span class="o">:</span> <span class="s2">&quot;tsd.hbase.rpcs.cumulative_bytes_received&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;tsuids&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
                              <span class="s2">&quot;downsample&quot;</span><span class="o">:</span> <span class="s2">&quot;1m-avg&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;rate&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                              <span class="s2">&quot;filters&quot;</span><span class="o">:</span> <span class="p">[{</span>
                                      <span class="s2">&quot;tagk&quot;</span><span class="o">:</span> <span class="s2">&quot;colo&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;filter&quot;</span><span class="o">:</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;group_by&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                                      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;wildcard&quot;</span>
                              <span class="p">},</span> <span class="p">{</span>
                                      <span class="s2">&quot;tagk&quot;</span><span class="o">:</span> <span class="s2">&quot;env&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;filter&quot;</span><span class="o">:</span> <span class="s2">&quot;prod&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;group_by&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                                      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;literal_or&quot;</span>
                              <span class="p">},</span> <span class="p">{</span>
                                      <span class="s2">&quot;tagk&quot;</span><span class="o">:</span> <span class="s2">&quot;role&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;filter&quot;</span><span class="o">:</span> <span class="s2">&quot;frontend&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;group_by&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                                      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;literal_or&quot;</span>
                              <span class="p">}],</span>
                              <span class="s2">&quot;rateOptions&quot;</span><span class="o">:</span> <span class="p">{</span>
                                      <span class="s2">&quot;counter&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                                      <span class="s2">&quot;counterMax&quot;</span><span class="o">:</span> <span class="mi">9223372036854775807</span><span class="p">,</span>
                                      <span class="s2">&quot;resetValue&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
                                      <span class="s2">&quot;dropResets&quot;</span><span class="o">:</span> <span class="kc">false</span>
                              <span class="p">},</span>
                              <span class="s2">&quot;tags&quot;</span><span class="o">:</span> <span class="p">{</span>
                                      <span class="s2">&quot;role&quot;</span><span class="o">:</span> <span class="s2">&quot;literal_or(frontend)&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;env&quot;</span><span class="o">:</span> <span class="s2">&quot;literal_or(prod)&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;colo&quot;</span><span class="o">:</span> <span class="s2">&quot;wildcard(*)&quot;</span>
                              <span class="p">}</span>
                      <span class="p">}],</span>
                      <span class="s2">&quot;delete&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
                      <span class="s2">&quot;noAnnotations&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
                      <span class="s2">&quot;globalAnnotations&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
                      <span class="s2">&quot;showTSUIDs&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
                      <span class="s2">&quot;msResolution&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
                      <span class="s2">&quot;showQuery&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
                      <span class="s2">&quot;showStats&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
                      <span class="s2">&quot;showSummary&quot;</span><span class="o">:</span> <span class="kc">false</span>
              <span class="p">},</span>
              <span class="s2">&quot;exception&quot;</span><span class="o">:</span> <span class="s2">&quot;null&quot;</span><span class="p">,</span>
              <span class="s2">&quot;executed&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
              <span class="s2">&quot;user&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
              <span class="s2">&quot;requestHeaders&quot;</span><span class="o">:</span> <span class="p">{</span>
                      <span class="s2">&quot;Accept-Language&quot;</span><span class="o">:</span> <span class="s2">&quot;en-US,en;q=0.8&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Host&quot;</span><span class="o">:</span> <span class="s2">&quot;tsdhost:4242&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Content-Length&quot;</span><span class="o">:</span> <span class="s2">&quot;440&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Referer&quot;</span><span class="o">:</span> <span class="s2">&quot;http://tsdhost:8080/dashboard/db/tsdfrontend&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Accept-Encoding&quot;</span><span class="o">:</span> <span class="s2">&quot;gzip, deflate&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;X-Forwarded-For&quot;</span><span class="o">:</span> <span class="s2">&quot;192.168.0.2&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;User-Agent&quot;</span><span class="o">:</span> <span class="s2">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.109 Safari/537.36&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Origin&quot;</span><span class="o">:</span> <span class="s2">&quot;http://tsdhost:8080&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Content-Type&quot;</span><span class="o">:</span> <span class="s2">&quot;application/json;charset=UTF-8&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Accept&quot;</span><span class="o">:</span> <span class="s2">&quot;application/json, text/plain, */*&quot;</span>
              <span class="p">},</span>
              <span class="s2">&quot;numRunningQueries&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
              <span class="s2">&quot;httpResponse&quot;</span><span class="o">:</span> <span class="p">{</span>
                      <span class="s2">&quot;code&quot;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
                      <span class="s2">&quot;reasonPhrase&quot;</span><span class="o">:</span> <span class="s2">&quot;OK&quot;</span>
              <span class="p">},</span>
              <span class="s2">&quot;queryStartTimestamp&quot;</span><span class="o">:</span> <span class="mi">1455552844368</span><span class="p">,</span>
              <span class="s2">&quot;queryCompletedTimestamp&quot;</span><span class="o">:</span> <span class="mi">1455552844621</span><span class="p">,</span>
              <span class="s2">&quot;sentToClient&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
              <span class="s2">&quot;stats&quot;</span><span class="o">:</span> <span class="p">{</span>
                      <span class="s2">&quot;avgAggregationTime&quot;</span><span class="o">:</span> <span class="mf">2.11416</span><span class="p">,</span>
                      <span class="s2">&quot;avgHBaseTime&quot;</span><span class="o">:</span> <span class="mf">200.267711</span><span class="p">,</span>
                      <span class="s2">&quot;avgQueryScanTime&quot;</span><span class="o">:</span> <span class="mf">242.037174</span><span class="p">,</span>
                      <span class="s2">&quot;avgScannerTime&quot;</span><span class="o">:</span> <span class="mf">200.474122</span><span class="p">,</span>
                      <span class="s2">&quot;avgScannerUidToStringTime&quot;</span><span class="o">:</span> <span class="mf">0.0</span><span class="p">,</span>
                      <span class="s2">&quot;avgSerializationTime&quot;</span><span class="o">:</span> <span class="mf">2.124153</span><span class="p">,</span>
                      <span class="s2">&quot;emittedDPs&quot;</span><span class="o">:</span> <span class="mi">716</span><span class="p">,</span>
                      <span class="s2">&quot;maxAggregationTime&quot;</span><span class="o">:</span> <span class="mf">2.093369</span><span class="p">,</span>
                      <span class="s2">&quot;maxHBaseTime&quot;</span><span class="o">:</span> <span class="mf">241.708782</span><span class="p">,</span>
                      <span class="s2">&quot;maxQueryScanTime&quot;</span><span class="o">:</span> <span class="mf">240.637231</span><span class="p">,</span>
                      <span class="s2">&quot;maxScannerUidtoStringTime&quot;</span><span class="o">:</span> <span class="mf">0.0</span><span class="p">,</span>
                      <span class="s2">&quot;maxSerializationTime&quot;</span><span class="o">:</span> <span class="mf">2.103411</span><span class="p">,</span>
                      <span class="s2">&quot;maxUidToStringTime&quot;</span><span class="o">:</span> <span class="mf">0.059345</span><span class="p">,</span>
                      <span class="s2">&quot;processingPreWriteTime&quot;</span><span class="o">:</span> <span class="mf">253.050907</span><span class="p">,</span>
                      <span class="s2">&quot;successfulScan&quot;</span><span class="o">:</span> <span class="mi">40</span><span class="p">,</span>
                      <span class="s2">&quot;totalTime&quot;</span><span class="o">:</span> <span class="mf">256.568992</span><span class="p">,</span>
                      <span class="s2">&quot;uidPairsResolved&quot;</span><span class="o">:</span> <span class="mi">0</span>
              <span class="p">}</span>
      <span class="p">}],</span>
      <span class="s2">&quot;running&quot;</span><span class="o">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, OpenTSDB.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.7.<br/>
    </p>
  </div>
</footer>
  </body>
</html>